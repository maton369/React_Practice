import { StrictMode } from 'react'
/*
  ✅ StrictMode（開発用の安全装置）
  ------------------------------------------------------------
  StrictMode は「アプリの動作を変えるための機能」ではなく、
  開発時に潜在バグを早期に見つけるための “検査モード” を有効にするラッパーである。

  ■ アルゴリズム観点での意味
  React の更新は大きく
    (1) render フェーズ：UIツリーを計算する（純粋計算が理想）
    (2) commit フェーズ：DOM反映・副作用確定
  の2段階で進む。

  StrictMode は、開発時に
  - render フェーズに副作用が混ざっていないか
  - useEffect 等の副作用管理が安全か
  - 非推奨APIが使われていないか
  を検出しやすくする。

  ■ 体感として起きること
  開発中は意図的に「2回実行っぽい挙動」が見えることがある。
  これは “副作用が偶然1回しか走らない前提” のコードを炙り出すためである。
*/

import { createRoot } from 'react-dom/client'
/*
  ✅ createRoot（React 18+ のルートAPI）
  ------------------------------------------------------------
  createRoot(container) は、ReactがDOMを管理する “起点（Root）” を作るAPIである。

  ■ ここでの重要ポイント（差分更新の前提）
  React は毎回「理想のUI」を入力として受け取り、
  前回の理想のUIとの *差分* だけを計算してDOMに反映する。

  そのため内部的には、概ね次のアルゴリズムが動く：

  1) 新しいUIツリー（React Elementツリー）を受け取る
  2) 以前のツリー（Fiberツリー）と比較し、変更点を計算（reconcile / 調停）
  3) DOMへ差分を適用（commit）

  createRoot で作られる root インスタンスは、
  この「前回ツリーの保持」と「次回との差分計算」を継続的に担う。
*/

import './index.css'
/*
  ✅ グローバルCSSの読み込み（Vite/バンドラの依存関係管理）
  ------------------------------------------------------------
  TS/JS から CSS を import すると、Vite がそれを依存関係グラフに組み込み、
  開発時はHMR（ホットリロード）対象にし、ビルド時はまとめて出力する。

  Reactの差分更新アルゴリズム（reconcile/commit）とは独立だが、
  最終的な見た目の結果は CSS に依存するので、エントリーポイントで読むことが多い。
*/

import App from './App.tsx'
/*
  ✅ ルートコンポーネント App
  ------------------------------------------------------------
  <App /> がアプリの最上位のUIツリーの入口になる。

  - DOM要素（'div', 'h1' 等）とは違い、App は “関数/クラス” でUIを返す。
  - props, state, hooks によって時間変化し、そのたびに差分更新の対象になる。
*/

createRoot(document.getElementById('root')!).render(
  /*
    ✅ container の取得と non-null assertion（!）
    ------------------------------------------------------------
    document.getElementById('root') は index.html にある
      <div id="root"></div>
    を取得する。

    TypeScript の '!' は「ここは null ではない前提」とコンパイラに伝える記法。
    - もし #root が存在しないなら実行時にエラーになり得る
    - テンプレでは #root が必ずある設計なので簡潔に書くために使われがち

    より堅牢にするなら null チェックして明示エラーを出す実装も可能。
  */

  /*
    ✅ root.render(...) の意味（宣言→差分計算→DOM反映）
    ------------------------------------------------------------
    root.render(x) は、Reactに「このツリーが今の理想のUIだ」と宣言する操作である。

    Reactは “命令的にDOMをいじる” のではなく、
    - 理想のUI（React Elementツリー）を受け取る
    - 前回のUIとの差分を計算して
    - 必要最小限だけDOMを更新する
    という方式をとる。

    初回レンダリング：
      - 前回ツリーが空 → DOMを構築して挿入

    再レンダリング（state更新などで発生）：
      - 前回ツリーと比較 → 変わった部分のみ更新
  */
  <StrictMode>
    {/*
      ✅ StrictMode をルートに置く理由
      ------------------------------------------------------------
      App 以下のすべてのコンポーネントに対して、
      開発時の追加検証（副作用の安全性チェック等）を有効化する。

      “将来的なレンダリングの中断/再開” や “再実行” が起きても壊れにくい設計
      （＝レンダリングは純粋、効果はEffectに閉じる）へ寄せる狙いがある。
    */}
    <App />
    {/*
      ✅ <App /> が作るツリーが差分更新の入力になる
      ------------------------------------------------------------
      <App /> は最終的に DOM 要素ツリーを返す（例：<div>...</div>）。

      Reactはその返り値ツリーを内部表現（Fiberツリー）として保持し、
      次回更新時に「前回Fiber」と「今回のUI」を比較して差分更新を行う。

      つまり App は「差分更新アルゴリズムの対象ツリーの根」である。
    */}
  </StrictMode>,
)
/*
  ✅ このコードは「オブジェクトスプレッド（object spread）...」を使って、
  - シャローコピー（新しいオブジェクトを作る）
  - 複数のオブジェクト/プロパティをマージして上書きする（後勝ち）
  を示している。

  `Object.assign` と同じ方向性の機能だが、スプレッドは構文として
  “どの順でコピー・上書きされるか” が見やすいのが特徴。

  ------------------------------------------------------------
  1) オブジェクトスプレッドのアルゴリズム（概念）
  ------------------------------------------------------------
  { ...source } は概念的に

    const target = {};
    for (const key of Object.keys(source)) target[key] = source[key];

  のように、source の「列挙可能な自前プロパティ（enumerable own properties）」を
  新しいオブジェクトへコピーする動作に近い。

  重要ポイント：
  - これは “シャローコピー” であり、ネストしたオブジェクトは参照共有になる
  - リテラル内で複数の ... を並べた場合、左から順に適用され、
    同名キーは後に出てきた値が勝つ（上書きされる）
  - `d: 100` のような通常のプロパティ指定も、スプレッドより後に書けば上書きになる

  ------------------------------------------------------------
  2) シャローコピー：{ ...original }
  ------------------------------------------------------------
*/

const original = { a: 1, b: 2, c: 3 };

const copy = { ...original };
/*
  ✅ original のプロパティを新しいオブジェクトへコピーする。
  - copy の中身は { a:1, b:2, c:3 }
  - ただし参照は別（新規オブジェクト）

  つまり “内容は同じだが、同一オブジェクトではない”。
*/
console.log(copy); // { a:1, b:2, c:3 }（表示は環境で多少異なる）
console.log(copy === original); // false（参照が違うため）

/*
  ------------------------------------------------------------
  3) マージと上書き：{ ...original, ...{ c:10, d:50 }, d:100 }
  ------------------------------------------------------------
*/

const assigned = { ...original, ...{ c: 10, d: 50 }, d: 100 };
/*
  ✅ これは “新しいオブジェクトを作って” そこに順番にコピーしている。
  重要：original 自体は変更されない（破壊的更新ではない）

  代入の流れ（概念的）：

  (1) 空オブジェクト target を作る

  (2) ...original を適用
      target = { a:1, b:2, c:3 }

  (3) ...{ c:10, d:50 } を適用
      - c は存在するので 3 -> 10 に上書き
      - d は無いので追加
      target = { a:1, b:2, c:10, d:50 }

  (4) d: 100 を適用（通常のプロパティ定義）
      - d は存在するので 50 -> 100 に上書き
      target = { a:1, b:2, c:10, d:100 }

  よって assigned は { a:1, b:2, c:10, d:100 } になる。

  また assigned は新しいオブジェクトなので、
  assigned === original は false（ここでは比較していないが）になる。
*/
console.log(assigned); // { a:1, b:2, c:10, d:100 }

/*
  ------------------------------------------------------------
  4) original はどうなる？（不変性）
  ------------------------------------------------------------
*/

console.log(original);
/*
  ✅ original はスプレッドで “読み出されてコピーされた” だけなので、
  内容は変わらず { a:1, b:2, c:3 } のまま。

  Reactの state 更新ではこの “元を変えずに新しい値を作る” 性質が重要になる。
*/
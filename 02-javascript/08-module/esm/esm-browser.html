<!--
  ✅ このHTMLは「ブラウザで ES Modules を使って外部ライブラリを import し、
  配列を加工して DOM に描画する」最小例である。

  重要ポイントは3つ：
  1) <script type="module"> による ES Modules 実行
  2) import による外部モジュール（lodash/uniq）の取り込み
  3) 配列→HTML文字列→innerHTML でリスト描画、というデータ変換パイプライン

  ------------------------------------------------------------
  1) ES Modules の実行モデル（type="module" の意味）
  ------------------------------------------------------------
  <script type="module"> は通常の script と違い、次の特性を持つ：

  - import/export が使える（ESMとして扱われる）
  - デフォルトで strict mode（this の挙動などが厳格）
  - モジュールは “スコープが分離” され、グローバル汚染が起きにくい
  - import は依存グラフを解決してから実行される（モジュールロード→評価の流れ）

  ざっくり言うと、ブラウザは
  (1) import を見て依存モジュールを取得
  (2) 依存を評価（トップレベルを実行）
  (3) 本体モジュールを評価
  の順で動く。

  ------------------------------------------------------------
  2) import uniq のアルゴリズム（何を持ってくる？）
  ------------------------------------------------------------
  import uniq from 'https://esm.sh/lodash/uniq.js';

  - esm.sh は npm パッケージをブラウザ向け ESM として配信してくれるCDN
  - ここでは lodash の uniq 関数（デフォルトエクスポート）を uniq という名前で受け取る

  uniq は一般に「配列の重複要素を取り除いた新しい配列を返す」関数である。
  （元配列を破壊せず、新配列を返すイメージ）

  ------------------------------------------------------------
  3) 配列処理パイプライン（データ→表示のアルゴリズム）
  ------------------------------------------------------------
  const arr = [...];
  const elems = uniq(arr)
    .map(n => `<li>${n}</li>`)
    .join('');

  これは次の3段階処理：

  (1) uniq(arr)
      - arr の要素を走査し、重複を除いた配列を作る
      - 結果は “ユニークな値の配列” になる

  (2) .map(n => `<li>${n}</li>`)
      - ユニーク配列の各要素 n を <li>...</li> の文字列に変換
      - 結果は “<li>文字列の配列” になる

  (3) .join('')
      - 配列の各要素（li文字列）を区切り文字なしで連結し、1つのHTML文字列にする
      - 結果は "<li>12</li><li>2</li>..." のような “HTML断片” になる

  ------------------------------------------------------------
  4) DOM反映アルゴリズム：innerHTML による一括描画
  ------------------------------------------------------------
  document.getElementById('list').innerHTML = elems;

  - id="list" の <ul> 要素を取得
  - innerHTML に HTML文字列を代入すると、ブラウザはその文字列をHTMLとしてパースし、
    子要素（li）をまとめて生成して差し込む

  これにより <ul> の中に <li> が並ぶ。

  ------------------------------------------------------------
  5) 注意点（実務観点）
  ------------------------------------------------------------
  - innerHTML は文字列をHTMLとして解釈するため、外部入力を混ぜるとXSSの原因になり得る。
    今回は固定データ（数値）なので安全寄りだが、一般には textContent / DOM API を使う判断も重要。
  - uniq の戻り順序は実装に依存し得るが、多くの場合「最初に出現した順」を保つ。
-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>ES Module Test</title>
  </head>
  <body>
    <ul id="list"></ul>

    <script type="module">
      // ✅ ES Modules の import：CDN（esm.sh）から lodash/uniq をブラウザ向け ESM として読み込む
      //    `uniq` は「配列から重複を除いた新しい配列」を返す関数（元配列は破壊しない想定）
      import uniq from 'https://esm.sh/lodash/uniq.js';

      // ✅ 重複を含む配列（描画対象データ）
      const arr = [12, 2, 2, 2, 9, 5, 12, 2, 15, 8, 9, 8];

      // ✅ データ変換パイプライン：
      // 1) uniq(arr) で重複除去 → ユニーク配列
      // 2) map で各数値を <li> のHTML文字列へ変換 → li文字列の配列
      // 3) join('') で連結し、1つのHTML断片（文字列）にする
      const elems = uniq(arr)
        .map(n => `<li>${n}</li>`)
        .join('');

      // ✅ DOM 反映：
      // id="list" の <ul> に対して innerHTML でまとめて差し込む
      // ブラウザは文字列をHTMLとしてパースして <li> 要素群を生成する
      document.getElementById('list').innerHTML = elems;
    </script>
  </body>
</html>
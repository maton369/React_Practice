// ✅ このコードは「JSON文字列を JSON.parse でオブジェクトに変換したあと、
// TypeScript では安全のため unknown として扱い、型を確定しない限りプロパティアクセスを禁止する」例である。
//
// 重要ポイント：
// - JSON.parse の戻り値は実行時には “何でもあり” になり得る（object / array / number / string / null ...）
// - そのため TypeScript では安易に型を決め打ちすると危険
// - unknown は「型が分からない」ことを明示する型で、
//   そのままではプロパティアクセス（user.id など）ができない
// - 安全に扱うには、型ガード（typeof / in / Array.isArray）やスキーマ検証で絞り込む必要がある

{
    // ✅ JSON形式の文字列（キーはダブルクォート、値も JSON の型規則に従う）
    // ここでは { id: number, username: string } の形を想定している。
    const str = `{ "id": 1, "username": "patty" }`;

    // ✅ JSON.parse は文字列をパースして “JavaScript の値” に変換する
    // ただし戻り値の形は入力に完全に依存し、静的には保証できない。
    //
    // そこで user を unknown として受けている：
    // - 「この値が何型か分からない」ことを型として表現する
    // - 型が分からないまま unsafe な操作（プロパティアクセス等）を防ぐ
    const user: unknown = JSON.parse(str);

    // ------------------------------------------------------------
    // ❌ unknown のままではプロパティアクセスできない
    // ------------------------------------------------------------
    // console.log(user.id, user.address.zipCode);
    /*
      ✅ これを有効化すると TypeScript でエラーになる（概念）
  
      理由：
      - user は unknown なので、コンパイラは
        「オブジェクトかどうか」「id があるか」「address があるか」すら確定できない
      - したがって user.id のようなアクセスは許可されない
  
      さらに、仮に user が object だったとしても address.zipCode が存在する保証もないため、
      実行時には `Cannot read properties of undefined` のような例外になり得る。
    */

    // ------------------------------------------------------------
    // ✅ 安全に扱う典型パターン（この例ではコメントとして理解用）
    // ------------------------------------------------------------
    /*
      1) “最低限オブジェクトである” ことを確認する（型ガード）
         if (typeof user === 'object' && user !== null) { ... }
  
      2) 必要なキーが存在し、型が合うことを確認する（in / typeof）
         if ('id' in user && typeof (user as any).id === 'number') { ... }
  
      3) あるいは Zod などのスキーマバリデーションで厳密に検証してから使う
         （この場合、検証が通った後は型を安全に確定できる）
    */
}